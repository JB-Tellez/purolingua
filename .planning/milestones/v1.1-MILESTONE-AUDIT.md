---
milestone: v1.1
audited: 2026-02-23T23:30:00Z
status: tech_debt
scores:
  requirements: 12/12
  phases: 3/3
  integration: 14/14
  flows: 7/7
gaps:
  requirements: []
  integration: []
  flows: []
tech_debt:
  - phase: 06-content-and-data
    items:
      - "Human review needed: A1 phrase content linguistic quality not verified by native speaker (flagged in RESEARCH.md and STATE.md as known concern)"
  - phase: 07-filter-logic
    items:
      - "Runtime test execution: filter-logic.test.js (19 tests) needs `bun run test` to confirm all 19 tests pass; static analysis verified correct structure"
  - phase: 08-filter-ui
    items:
      - "Browser check: chip visual appearance (pill shape, teal fill, hover transition) needs `bun run dev` visual confirmation"
      - "Browser check: FLTR-06 guard interactive behavior (chip stays visually active on click) needs browser observation"
      - "Browser check: chips absent during flashcard study view needs browser observation"
      - "Browser check: chip active state survives page refresh (localStorage round-trip) needs browser observation"
  - phase: cross-phase
    items:
      - "FLTR-03 edge case (product decision): resetProgress() does not call initActiveLevels(); a user who had progress, set a custom filter, then reset progress will keep their custom filter on next load rather than defaulting to A1-only. Whether 'reset progress' should also reset filter preference is undecided."
---

# Milestone v1.1 Difficulty Levels — Audit Report

**Milestone:** v1.1 Difficulty Levels
**Audited:** 2026-02-23
**Status:** ⚡ tech_debt — All requirements met. No critical blockers. Accumulated deferred items need review.
**Score:** 12/12 requirements satisfied | 7/7 E2E flows complete | 14/14 cross-phase wires confirmed | 0 broken flows

---

## Requirements Coverage (3-Source Cross-Reference)

Cross-referenced three independent sources for each requirement:
1. **REQUIREMENTS.md Traceability Table** — checkbox state + Status column
2. **Phase VERIFICATION.md** — Requirements Coverage table
3. **Phase SUMMARY.md frontmatter** — `requirements-completed` list

| REQ-ID | Description | VERIFICATION | SUMMARY | REQUIREMENTS.md | Final Status |
|--------|-------------|:------------:|:-------:|:---------------:|:------------:|
| CONT-01 | 160 existing cards have `level: "A2"` (IT + ES) | SATISFIED | 06-01, 06-02, 06-03 | `[x]` Complete | **satisfied** |
| CONT-02 | Italian decks: A1 content all 8 categories (min 4/deck) | SATISFIED | 06-01, 06-03 | `[x]` Complete | **satisfied** |
| CONT-03 | Spanish decks: A1 content all 8 categories (min 4/deck) | SATISFIED | 06-02, 06-03 | `[x]` Complete | **satisfied** |
| FLTR-01 | User can filter by level using A1/A2 chips | SATISFIED | 08-01, 08-02 | `[x]` Complete | **satisfied** |
| FLTR-02 | Level filter is multi-select (A1, A2, or both) | SATISFIED | 07-01, 07-02 | `[x]` Complete | **satisfied** |
| FLTR-03 | New users default to A1 only | SATISFIED | 07-01, 07-02, 07-03 | `[x]` Complete | **satisfied** ⚠ edge case |
| FLTR-04 | Returning users default to A1+A2 | SATISFIED | 07-01, 07-02, 07-03 | `[x]` Complete | **satisfied** |
| FLTR-05 | Level filter persists via localStorage | SATISFIED | 07-01, 07-02, 07-03 | `[x]` Complete | **satisfied** |
| FLTR-06 | At least one level must remain selected | SATISFIED | 07-01, 07-02 | `[x]` Complete | **satisfied** |
| FLTR-07 | Badge count and session use same filter (count parity) | SATISFIED | 07-03, 07-04 | `[x]` Complete | **satisfied** |
| FLTR-08 | Quiz distractors drawn from level-filtered pool only | SATISFIED | 07-03, 07-04 | `[x]` Complete | **satisfied** |
| FLTR-09 | Chip labels defined in i18n system | SATISFIED | 08-01, 08-02 | `[x]` Complete | **satisfied** |

**No orphaned requirements.** All 12 REQ-IDs in the traceability table are present in at least one VERIFICATION.md and at least one SUMMARY.md frontmatter list.

**FLTR-03 edge case:** `resetProgress()` in `app.js` lines 560–570 does not call `initActiveLevels()` after `resetAllProgress()`. A user who had progress, manually set a custom filter, then reset progress will keep that filter on the next page load — bypassing the A1-only default. Core requirement behavior (new users default A1-only) is correct; this only affects the "reset-then-reload" sub-path. Classified as tech debt / product decision, not a requirement violation.

---

## Phase Verification Summary

| Phase | Status | Score | Gaps | Notes |
|-------|--------|-------|------|-------|
| 06-content-and-data | ✅ passed | 8/8 | 0 | Human: A1 linguistic quality review |
| 07-filter-logic | ⚠ human_needed | 10/10 (static) | 0 | Human: `bun run test` to confirm 19 tests pass at runtime |
| 08-filter-ui | ✅ passed | 9/9 | 0 | Human: 4 browser visual checks |

All three phase VERIFICATION.md files exist. No unverified phases.

---

## Cross-Phase Integration

### Wiring Map

| From | To | Via | Status |
|------|----|-----|--------|
| Phase 6 `card.level` field | Phase 7 `getDueCount()` | `activeLevels.includes(card.level)` predicate (progress.js:113) | ✅ WIRED |
| Phase 6 `card.level` field | Phase 7 `startDeck()` | `levels.includes(card.level) && isCardDue()` predicate (app.js:266) | ✅ WIRED |
| Phase 6 `card.level` field | Phase 7 `renderCard()` / `generateChoices()` | `activeLevels.includes(c.level)` pre-filter (app.js:305) | ✅ WIRED |
| Phase 7 `getActiveLevels` / `setActiveLevels` | Phase 8 `renderFilterChips()` | import at app.js:8 | ✅ WIRED |
| Phase 7 `updateActiveLevels` | Phase 8 chip click handler | `updateActiveLevels(next)` in setupEventListeners (app.js:541) | ✅ WIRED |
| Phase 7 `loadLevelFilter` / `saveLevelFilter` | Phase 8 chip state persistence | called in `initActiveLevels()` and `updateActiveLevels()` | ✅ WIRED |
| Phase 7 `hasProgressData` | Phase 7/8 new-user default | `initActiveLevels()` checks `hasProgressData()` before setting default | ✅ WIRED |
| Phase 8 `renderFilterChips()` | `renderDecks()` | called as first statement in `renderDecks()` (app.js:241) | ✅ WIRED |
| Phase 8 `#level-filter` HTML | Phase 8 event delegation | `addEventListener('click')` on `#level-filter` in `setupEventListeners()` (app.js:531) | ✅ WIRED |
| Phase 8 `data-i18n="filters.levelA1"` | Phase 8 `it/ui.js` / `es/ui.js` | `initializeI18n()` scans `[data-i18n]` elements (app.js:141-144) | ✅ WIRED |
| `tests/data-integrity.test.js` | `src/locales/it/decks.js`, `src/locales/es/decks.js` | ES module import | ✅ WIRED |
| `tests/filter-logic.test.js` | `state.js`, `progress.js`, `deck-utils.js` | direct source imports | ✅ WIRED |
| `tests/filter-ui.test.js` | `it/ui.js`, `es/ui.js`, `app.js` (renderFilterChips) | direct source imports | ✅ WIRED |
| `tests/deck-utils.test.js` | `deck-utils.js` new `generateChoices` signature | calls `generateChoices(card, mockDeck.cards)` — compatible with new signature | ✅ WIRED |

**Orphaned exports:** None. All 14 connections verified.

---

## E2E Flows

| Flow | Status | Notes |
|------|--------|-------|
| New user opens app → A1 chip active → badge shows A1-only | ✅ Complete | `initActiveLevels()` → `hasProgressData()` false → `['A1']` default |
| Returning user opens app → A1+A2 active → combined badge | ✅ Complete | `loadLevelFilter()` restores saved preference, or `hasProgressData()` true → `['A1','A2']` |
| User clicks chip → filter updates → badge and session use new filter | ✅ Complete | Event delegation → `updateActiveLevels(next)` → `renderDecks()` → `getDueCount/startDeck` both use `getActiveLevels()` |
| User clicks only-active chip → FLTR-06 guard fires → nothing changes | ✅ Complete | `next = []` → `setActiveLevels([])` → guard `if (!levels || length === 0) return` → state unchanged |
| User switches language → filter reloads for new locale | ✅ Complete | `switchLanguage()` → `loadProgress()` → `initActiveLevels()` → `loadLevelFilter()` with new locale key |
| User refreshes page → filter state restored from localStorage | ✅ Complete | `loadLevelFilter()` reads `${locale}-level-filter` on init |
| User studies deck → chips hidden → quiz uses only filtered-level distractors | ✅ Complete | Chips inside `#deck-selection` auto-hidden; `renderCard()` pre-filters `filteredCards` before `generateChoices()` |

**Broken flows:** 0

---

## Tech Debt (Non-Blocking)

### Phase 6 — Content and Data

- **A1 content linguistic quality:** 320 A1 phrase cards synthesized from AI training data; not reviewed by native Italian or Spanish speaker. Pre-documented concern from RESEARCH.md and STATE.md. Low risk for v1.1; recommend native review before v2.0 content expansion.

### Phase 7 — Filter Logic

- **Runtime test confirmation:** `filter-logic.test.js` has 19 tests; structural analysis confirms all are correct but `bun run test` execution was not possible in the AI environment due to a pre-existing jsdom@27/bun compatibility constraint. Run `bun run test` to confirm green at runtime. Full 58-test suite reported passing in Phase 8 verification.

### Phase 8 — Filter UI

- **Browser visual checks (4 items):**
  1. Chip visual appearance (pill shape, teal fill, hover transition)
  2. FLTR-06 guard interactive behavior (chip stays visually active on ignored click)
  3. Chips absent during flashcard study view
  4. Chip active state survives page refresh (localStorage round-trip)

### Cross-Phase — Product Decision

- **FLTR-03 post-reset edge case:** `resetProgress()` in `app.js` does not clear or re-derive the level filter after resetting SRS progress. Path: user sets custom filter → resets progress → reloads page → custom filter persists rather than defaulting to A1-only. Product owner should decide: should "Reset Progress" also reset the level filter? Simple fix if desired: add `updateActiveLevels(['A1'])` (or `initActiveLevels()`) in `resetProgress()` after `resetAllProgress()`.

---

## Summary

**Status: ⚡ tech_debt**

All 12 v1.1 requirements are satisfied across three independent verification sources. All 7 E2E user flows complete without interruption. All 14 cross-phase wiring connections confirmed. Zero critical blockers or broken flows.

Deferred items:
- 1 content quality review (A1 linguistic)
- 1 runtime test confirmation (bun run test)
- 4 browser visual checks
- 1 product decision (post-reset filter behavior)

None of these block milestone completion. Recommended action: complete the milestone and track the post-reset edge case in the next milestone's requirements.

---

*Audited: 2026-02-23*
*Auditor: Claude (gsd-auditor)*
